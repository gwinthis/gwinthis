---
layout: post
title: git基础
tags: [技术,配置管理,git,研发]
categories: 技术
---

> 一个明智的人总是抓住机遇，把它变成美好的未来。——托·富勒

同生活中的许多伟大事物一样，Git 诞生于一个极富纷争大举创新的年代。Linux 内核开源项目有着为数众广的参与者。 绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上（1991－2002年间）。 到 2002 年，整个项目组开始启用一个专有的分布式版本控制系统 BitKeeper 来管理和维护代码。

到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了 Linux 内核社区免费使用 BitKeeper 的权力。 这就迫使 Linux 开源社区（特别是 Linux 的缔造者 Linus Torvalds）基于使用 BitKeeper 时的经验教训，开发出自己的版本系统。 他们对新的系统制订了若干目标：

* 速度
* 简单的设计
* 对非线性开发模式的强力支持（允许成千上万个并行开发的分支）
* 完全分布式
* 有能力高效管理类似 Linux 内核一样的超大规模项目（速度和数据量）

自诞生于 2005 年以来，Git 日臻成熟完善，在高度易用的同时，仍然保留着初期设定的目标。 它的速度飞快，极其适合管理大项目，有着令人难以置信的非线性分支管理系统。

git是一种版本控制系统，传统的版本控制系统还有cvs、svn等。如果有使用有cvs、svn的经历，并拿着这些经验套用git的话，你会很迷惑为啥git commit后还要push，为啥修改非新增的文件也需要add才能commit，为啥这么多奇怪的命令和概念。如果仅从版本控制的操作命令而言git的操作的确比svn复杂，增加了不少新概念，但就是这些新概念给git增加了强大的产品能力。git是一个分布式的版本控制系统，也就是所有的版本控制都可以在本地操作，然后最后与其他群体成员分享。这一点同传统版本控制管理系统有本质差别。git除了控制版本以外，也为研发协同提供了更多的支持，后面我们简述不同场景要使用何种命令。本文重点讲述git的基本概念和常用命令。

git是一个分布式版本控制管理系统，每一个git客户端具备仓库需要的所有概念，远程服务器只是用来共享存储。git有三个工作区：Git仓库、工作目录以及暂存区域。  

* Git仓库目录是git用来保存项目的元数据和对象数据库的地方。这是git最重要的部分，从其他计算机clone仓库的时候，拷贝的就是这里的数据。
* 工作目录是对项目的某个版本独立拉取出来的内容。这些从git压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。
* 暂存区域是一个文件，保存了将提交的文件列表信息，一般在Git仓库目录中，有时候也会称作索引。

既然有三个工作区，文件的生命周期就有三部分状态：committed 、modified、staged。已提交表示数据已经安全的保存在本地数据库中。 已修改表示修改了文件，但还没保存到数据库中。 已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。

git的工作区了解清楚之后，git的工作区命令就很容易掌握了。从无到有的时候，我们首先要创建一个仓库，一般有两种方式：  
1）本地初始化 git init；  
2）从其他服务器clone, git clone [url]。  

仓库刚初始化的时候，无论采用何种方式，文件的初始状态都是stated并且unmodified的状态。在操作的过程，我们会修改原有文件，状态会成为modifid，add之后会成为staged状态，commit之后会重新成为unmodified。我们新增加文件的时候，状态是untracked，add之后成为stated，commit之后成为unmodified。我们删除一个原有文件时，文件状态会从unmodified改成untracked。如果修改git commit的内容，可以使用git commit --amend


除了工作区，git还有一个非常重要的概念，就是分支。为什么需要分支管理，因为突发事件，当我们想专心做一件事情的时候，总会有突发灵感或线上故障的情况。这个时候，我们要做的是基于一个版本再开辟一个工作空间来开发。git的分支与传统分布式管理系统有本质的差别，例如svn每个分支都是一套文件，而git的分支仅仅是一个指针，指向commits一个节点的指针。好，我们又引出了一个概念：commits。

commits是commit对象集合，每个commit对象包括以下内容：作者、提交者、提交树、父提交对象id。每个commit对象都会引用父对象的id，用来关联上一个提交内容，而整个commits是一个有向无环图。提交树包括目录结构以及每个提交文件的对象索引，每个对象索引关联一个blob对象，也就是每个文件提交时刻的快照。git在commits基础上，做指针的快进（merge）、commit对象重新生成（rebase）和回滚。了解分支和commit对象的概念之后，围绕这两个概念的命令也更容易理解。常用的命令包括：  
1) git branch  
2) git checkout  
3) git merge  
4) git rebase











